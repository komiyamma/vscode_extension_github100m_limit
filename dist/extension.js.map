{"version":3,"file":"extension.js","mappings":"swBAAA,kBACA,YAEA,oBAAyBA,GAErBC,QAAQC,IAAI,6EAEZ,IAAIC,EAAaC,EAAOC,SAASC,gBAAgB,8CAA8C,SAK/FF,EAAOG,UAAUC,uBAAuBC,IAEnBA,EAAMC,SAY/B,WAEI,GADuBN,EAAOG,UAAUI,iBAClB,CAClB,IAAIC,EAAeR,EAAOG,UAAUI,mBAAmB,GAEvD,GAAIC,EAAc,CACd,IAAIC,EAAkBD,EAAaE,IAC/BC,EAAiBF,EAAgBG,OAAS,eAC9C,IAAKC,EAAGC,WAAWH,GAEf,OAAO,EAEX,IAAII,EAAuBN,EAAgBG,OAAS,4BAChDI,EAAqBP,EAAgBG,OAAS,0BAC9CK,EAAoBR,EAAgBG,OAAS,yBAC7CM,EAAkBT,EAAgBG,OAAS,uBAE/C,GAAIC,EAAGC,WAAWC,IAAyBF,EAAGC,WAAWE,IAAuBH,EAAGC,WAAWG,IAAsBJ,EAAGC,WAAWI,GAC9H,OAAO,EAGX,IAAIC,EAAoBV,EAAgBG,OAAS,yBACjD,GAAIC,EAAGC,WAAWK,GAEd,OAAO,EACJ,CAGH,MAAMC,EAAgB,6mBAuBtBP,EAAGQ,cAAcF,EAAmBC,EAExC,CACJ,CACJ,CACJ,CA7DQE,EAAiB,IAErB1B,EAAQ2B,cAAcC,KAAKzB,EAC/B,EA6DA,wBAA8B,C,UCrF9B0B,EAAOC,QAAUC,QAAQ,S,UCAzBF,EAAOC,QAAUC,QAAQ,K,GCCrBC,EAA2B,CAAC,ECE5BC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaN,QAGrB,IAAID,EAASG,EAAyBG,GAAY,CAGjDL,QAAS,CAAC,GAOX,OAHAQ,EAAoBH,GAAUI,KAAKV,EAAOC,QAASD,EAAQA,EAAOC,QAASI,GAGpEL,EAAOC,OACf,CCnB0BI,CAAoB,K","sources":["webpack://github100mbyteslimithook/./src/extension.ts","webpack://github100mbyteslimithook/external commonjs \"vscode\"","webpack://github100mbyteslimithook/external node-commonjs \"fs\"","webpack://github100mbyteslimithook/webpack/bootstrap","webpack://github100mbyteslimithook/webpack/startup"],"sourcesContent":["import * as vscode from 'vscode';\r\nimport * as fs from 'fs';\r\n\r\nexport function activate(context: vscode.ExtensionContext) {\r\n\r\n    console.log('Congratulations, your extension \"github100mbyteslimithook\" is now active!');\r\n\r\n    let disposable = vscode.commands.registerCommand('github100mbyteslimithook.initializeCommand', () => {\r\n        // vscode.window.showInformationMessage('Hello World from Github100MBytesLimiterHook!');\r\n    });\r\n\r\n    // ワークスペース内のテキストドキュメントが開かれたときに呼び出されるコールバック\r\n    vscode.workspace.onDidOpenTextDocument((event) => {\r\n        // 開かれたファイルのパスを取得\r\n        const fileName = event.fileName;\r\n\r\n        // vscode.window.showInformationMessage('ディレクトリが開かれました: ' + fileName);\r\n\r\n        // gitリポジトリのディレクトリかどうかを判定\r\n        // ここでfileNameに対する判定ロジックを実装\r\n\r\n        createPreCommit();\r\n    });\r\n    context.subscriptions.push(disposable);\r\n}\r\n\r\nfunction createPreCommit() {\r\n    let workspaceFolders = vscode.workspace.workspaceFolders;\r\n    if (workspaceFolders) {\r\n        let activeFolder = vscode.workspace.workspaceFolders?.[0];\r\n\r\n        if (activeFolder) {\r\n            let activeFolderUri = activeFolder.uri;\r\n            let configFilePath = activeFolderUri.fsPath + '/.git/config';\r\n            if (!fs.existsSync(configFilePath)) {\r\n                // vscode.window.showInformationMessage(\"Configが無い\");\r\n                return false;\r\n            }\r\n            let postCheckoutFilePath = activeFolderUri.fsPath + '/.git/hooks/post-checkout';\r\n            let postCommitFilePath = activeFolderUri.fsPath + '/.git/hooks/post-commit';\r\n            let postMergeFilePath = activeFolderUri.fsPath + '/.git/hooks/post-merge';\r\n            let prePushFilePath = activeFolderUri.fsPath + '/.git/hooks/pre-push';\r\n            // これはLFSで初期化されている\r\n            if (fs.existsSync(postCheckoutFilePath) && fs.existsSync(postCommitFilePath) && fs.existsSync(postMergeFilePath) && fs.existsSync(prePushFilePath)) {\r\n                return false;\r\n            }\r\n\r\n            let preCommitFilePath = activeFolderUri.fsPath + '/.git/hooks/pre-commit';\r\n            if (fs.existsSync(preCommitFilePath)) {\r\n                // vscode.window.showInformationMessage('pre-commitファイル発見!!: ' + preCommitFilePath);\r\n                return false;\r\n            } else {\r\n                // vscode.window.showErrorMessage('pre-commitファイルなし!! 作成できる!!: ' + preCommitFilePath);\r\n\r\n                const scriptContent = `#!/bin/sh\r\n\r\ntoplevel=$(git rev-parse --show-toplevel)\r\nif [ -z \"$toplevel\" ]; then\r\n    exit 0\r\nfi\r\n\r\nif [ -f \"$toplevel/.git/hooks/post-checkout\" ] && \r\n    [ -f \"$toplevel/.git/hooks/post-commit\" ] &&\r\n    [ -f \"$toplevel/.git/hooks/post-merge\" ] &&\r\n    [ -f \"$toplevel/.git/hooks/pre-push\" ]; then\r\n    exit 0\r\nfi\r\n\r\nlimit=104857600 # 100MB in bytes\r\ngit diff --cached --name-only | while IFS= read -r file; do\r\n    file_size=$(stat -c %s \"$file\" 2>/dev/null)\r\n    if [ \"$file_size\" -gt \"$limit\" ]; then\r\n        echo \"Error: Cannot commit a file larger than 100 MB. Abort commit.\"\r\n        exit 1\r\n    fi\r\ndone\r\n`;\r\n                fs.writeFileSync(preCommitFilePath, scriptContent);\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// This method is called when your extension is deactivated\r\nexport function deactivate() {}\r\n","module.exports = require(\"vscode\");","module.exports = require(\"fs\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(265);\n"],"names":["context","console","log","disposable","vscode","commands","registerCommand","workspace","onDidOpenTextDocument","event","fileName","workspaceFolders","activeFolder","activeFolderUri","uri","configFilePath","fsPath","fs","existsSync","postCheckoutFilePath","postCommitFilePath","postMergeFilePath","prePushFilePath","preCommitFilePath","scriptContent","writeFileSync","createPreCommit","subscriptions","push","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}